CREATE SCHEMA sport_league;


CREATE TABLE IF NOT EXISTS players_teams(
player_id INT REFERENCES players (id) NOT NULL ,
team_id INT REFERENCES teams (id) NOT NULL
);

DROP TABLE players;

CREATE TABLE IF NOT EXISTS players(
    id serial PRIMARY KEY,
    firstname VARCHAR(64) NOT NULL,
    lastname VARCHAR(64) NOT NULL,
    patronymic VARCHAR(64),
    sports_category VARCHAR(12),
    birthdate DATE NOT NULL ,
    height INT NOT NULL
);

CREATE TABLE IF NOT EXISTS stadiums(
                                      id serial PRIMARY KEY,
                                      name VARCHAR(64) NOT NULL ,
                                      address VARCHAR(128) NOT NULL
);

CREATE TABLE IF NOT EXISTS teams(
                                      id serial PRIMARY KEY,
                                      name VARCHAR(64) NOT NULL ,
                                      stadium_id INT REFERENCES stadiums (id) NOT NULL
);

CREATE TABLE IF NOT EXISTS seasons(
    id serial PRIMARY KEY ,
    name VARCHAR(16) NOT NULL
);

CREATE TABLE IF NOT EXISTS tournaments(
    id serial PRIMARY KEY ,
    name VARCHAR NOT NULL ,
    season_id INT REFERENCES seasons (id) NOT NULL
);

CREATE TABLE IF NOT EXISTS tournaments_teams(
    id serial PRIMARY KEY ,
    tournament_id INT REFERENCES tournaments (id) NOT NULL ,
    team_id INT REFERENCES teams (id),
    points INT NOT NULL
);

CREATE TABLE IF NOT EXISTS matches(
    id serial PRIMARY KEY ,
    tournament_id INT REFERENCES tournaments (id),
    winner_id INT REFERENCES teams (id),
    loser_id INT REFERENCES teams (id) NOT NULL,
    date TIMESTAMP NOT NULL ,
    stadium_id INT REFERENCES stadiums (id)
);